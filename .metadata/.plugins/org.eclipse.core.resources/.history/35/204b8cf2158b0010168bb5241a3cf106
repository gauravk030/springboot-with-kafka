package com.test.service;

@Service
public class TypedProducer {

    private final KafkaTemplate<String, UserEvent> userKafkaTemplate;
    private final KafkaTemplate<String, OrderEvent> orderKafkaTemplate;

    public TypedProducer(KafkaTemplate<String, UserEvent> userKafkaTemplate,
                         KafkaTemplate<String, OrderEvent> orderKafkaTemplate) {
        this.userKafkaTemplate = userKafkaTemplate;
        this.orderKafkaTemplate = orderKafkaTemplate;
    }

    public void sendUser(UserEvent user) {
        userKafkaTemplate.send("user-events", user);
    }

    public void sendOrder(OrderEvent order) {
        orderKafkaTemplate.send("order-events", order);
    }
}

